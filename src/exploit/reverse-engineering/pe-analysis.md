---
title: PE (Portable Executable) Analysis
description: The Portable Executable format is a file format for executables, object code, DLLs and others used in 32-bit and 64-bit versions of Windows.
tags:
    - Reverse Engineering
    - Windows
refs:
date: 2023-11-11
draft: false
---

## Investigation

```bash
file example.exe
strings example.exe
```

### PE Headers

There are many tools to analyze PE headers, such as `wxHexEditor`, `pe-tree`.  
[pe-tree](https://github.com/blackberry/pe_tree) is a tool that views PE files in a tree-view. It will take about a few minutes to open.

```sh
pe-tree ./executable
```

<br />

|Structure|Description|
|---|---|
|IMAGE_DOS_HEADER|It consists of the first 64 bytes of the PE file. The first two bytes (”4D 5A”) means the “MZ” characters which are an identity of the Portable Executable format.|
|DOS_STUB|It is a small piece of code that only runs if the PE file is incompatible with the system it is being run on. At such time the message “!This program cannot be run in DOS mode" will be displayed.|
|IMAGE_NT_HEADERS|It contains most of the vital information related to the PE file. The starting address of the IMAGE_NT_HEADERS is found in `e_lfanew` from the IMAGE_DOS_HEADER. It contains `NT_HEADERS`, `IMAGE_SECTION_HEADER`, `IMAGE_IMPORT_DESCRIPTION`|

### Identify Packers of Packed Executable

[pecheck](https://github.com/DidierStevens/DidierStevensSuite/blob/master/pecheck.py) is a command-line tool which analyze PE files.

```sh
pecheck ./executable
```

When results appears, check the section name in the PE Section.

<br />

## Decompiler, Disassembler, Debugger

- **dnSpy**
- **ILSpy**
- **[AnaloniaILSpy](https://github.com/icsharpcode/AvaloniaILSpy)**
- **Cutter**
- **Ghidra**
- **Binary Ninja**

Also we can use online tools like **Decompiler Explorer**.
