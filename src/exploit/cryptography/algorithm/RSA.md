---
title: RSA (Rivest Shamir Adleman)
description: RSA is a public-key cryptosystem that is widely used for secure data transmission.
tags:
    - Cryptography
refs:
date: 2023-07-23
draft: false
---

## Decrypt

```bash
openssl pkeyutl -decrypt -in ciphertext -inkey private-key.pem
```

<br />

## Encrypt

```bash
openssl pkeyutl -encrypt -in plain.txt -inkey public-key.pem -pubin
```

<br />

## Generate a Keypair

### Generate a Private Key

```bash
# genrsa: Generate an RSA private key
openssl genrsa -out private-key.pem 2048
```

### Generate a Public Key

We use the private key which was generated in the previous section.

```bash
openssl rsa -in private-key.pem -pubout -out public-key.pem
```

<br />

## View the Prime Number

```bash
openssl rsa -in private-key.pem -text -noout
```

<br />

## Diffie-Hellman Exchange

```bash
openssl dhparam -out dhparams.pem 2048
```

### View the Prime Number

```bash
openssl dhparam -in dhparams.pem -text -noout
```

<br />

## Implement RSA Algorithm in Python

Reference: [https://medium.com/@gowtham180502/implementing-rsa-algorithm-using-python-836f7da2a8e0](https://medium.com/@gowtham180502/implementing-rsa-algorithm-using-python-836f7da2a8e0)

We can create RSA algorithm in Python.

```python
from Crypto.Util.number import getPrime, long_to_bytes
from math import gcd # for greatest common divisor

class RSA:
	def __init__(self):
		# p, q (large prime numbers)
		self.p = getPrime(512)
		self.q = getPrime(512)

		# calculate n (n is used for both the public key (n, e) and the private key (n, d))
		self.n = p * q

		# calculate t (totient, or called as 'phi')
		self.t = (p - 1) * (q - 1)

		# calculate e (e is one of the puclic key (n, e))
		for i in range(2, t):
			if gcd(i, t) == 1:
            e = i
            break

		# calculate d (d is one of the private key(e, d))
		d = pow(e, -1, t)

	def encrypt(self, plaintext: str):
		# ciphertext = plaintext ** e % n
		ct = pow(int(plaintext.encode().hex(), 16), e, n)
		return long_to_bytes(ct)

	def decrypt(self, ciphertext):
		# plaintext = ciphertext ** d % n
		pt = pow(int(ciphertext.hex()), d, n)
		return long_to_bytes(pt)

msg = "Hello"

rsa = RSA()
enc_msg = rsa.encrypt(msg)
dec_msg = rsa.decrypt(enc_msg)
```